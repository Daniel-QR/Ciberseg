<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CiberSeg - Herramientas de Ciberseguridad</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #0057b7; /* Azul Cobalto */
            --secondary-color: #e0e0e0; /* Gris claro */
            --background-start: #1a1a1a; /* Negro */
            --background-end: #2b2b2b; /* Gris oscuro */
            --card-bg: rgba(40, 40, 40, 0.9); /* Gris oscuro semi-transparente */
            --text-color: #ffffff;
            --border-color: #444;
            --green-score: #4caf50; /* Verde brillante */
            --red-score: #f44336; /* Rojo intenso */
            --font-family: 'Poppins', sans-serif;
        }

        body {
            font-family: var(--font-family);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            background: linear-gradient(-45deg, var(--background-start), var(--background-end));
            background-size: 400% 400%;
            animation: gradient-animation 15s ease infinite;
        }
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            background-color: var(--card-bg);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            max-width: 900px;
            width: 90%;
            margin: 20px;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        h1, h2, h3 {
            color: var(--secondary-color);
            margin-top: 0;
            font-weight: 600;
        }

        .section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .section.active {
            opacity: 1;
            transform: translateY(0);
        }

        .logo-container {
            margin-bottom: 20px;
        }
        .logo {
            max-width: 30%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        .section-box, .login-box, .form-box, .tool-box {
            background-color: rgba(60, 60, 60, 0.7);
            border: 1px solid var(--border-color);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            text-align: left;
        }

        .form-box input[type="text"], .form-box input[type="email"], .form-box input[type="number"], .form-box select, .password-container input[type="password"], .password-container input[type="text"], #login-form input[type="password"], #login-form input[type="text"] {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border-radius: 8px;
            border: 1px solid #555;
            background-color: var(--secondary-color);
            color: var(--background-start);
            box-sizing: border-box;
            font-family: var(--font-family);
        }
        .form-box input:focus, .form-box select:focus, .password-container input:focus, #login-form input:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--primary-color);
        }

        .button-submit {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s, transform 0.2s;
            width: 100%;
            box-sizing: border-box;
            font-weight: 600;
        }
        .button-submit:hover {
            background-color: #fff;
            color: #333;
            transform: translateY(-2px);
        }
        .button-secondary {
            background-color: transparent;
            color: var(--primary-color);
            padding: 15px 30px;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s, transform 0.2s;
            width: 100%;
            box-sizing: border-box;
            margin-top: 15px;
            font-weight: 600;
        }
        .button-secondary:hover {
            background-color: #fff;
            color: #333;
            transform: translateY(-2px);
        }
        .hidden {
            display: none;
        }

        .tool-cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .tool-card {
            background-color: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
            text-align: center;
        }
        .tool-card:hover {
            background-color: #fff;
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
        }
        .tool-card:hover h3, .tool-card:hover p {
            color: #333;
        }
        .tool-card h3 {
            margin-top: 10px;
            color: var(--secondary-color);
            font-weight: 600;
            transition: color 0.3s;
        }
        .tool-card p {
            font-size: 0.9em;
            color: var(--text-color);
            margin-bottom: 0;
            transition: color 0.3s;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease-in-out;
        }
        .modal.show {
            opacity: 1;
            pointer-events: auto;
        }
        .modal-content {
            background-color: #2c2c2c;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
            width: 90%;
            max-width: 500px;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.4s ease-in-out;
            color: #ffffff;
        }
        .modal.show .modal-content {
            transform: scale(1);
        }
        .close-button {
            float: right;
            font-size: 28px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
            transition: color 0.3s;
        }
        .close-button:hover {
            color: var(--primary-color);
        }
        .quiz-result-percentage {
            font-size: 3em;
            font-weight: bold;
        }
        .green-score { color: var(--green-score); }
        .red-score { color: var(--red-score); }
        .result-level {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .low-risk { color: var(--red-score); }
        .high-risk { color: var(--green-score); }

        /* Existing styles */
        .admin-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .metric-card, .chart-container {
            background-color: #2c2c2c;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        .metric-card .value {
            font-size: 2.5em;
            font-weight: bold;
            color: var(--primary-color);
        }
        .chart-container h3 {
            margin-bottom: 15px;
        }
        .chart-placeholder {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 250px;
            overflow: hidden;
        }
        .chart-placeholder img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 5px;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .chart-placeholder img:hover {
            transform: scale(1.2);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }
        .user-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            color: #ccc;
        }
        .user-table th, .user-table td {
            border: 1px solid #444;
            padding: 10px;
            text-align: left;
        }
        .user-table th {
            background-color: #222;
            color: white;
        }
        .email-container {
            border: 1px solid #444;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            cursor: pointer;
            text-align: left;
            background-color: #2c2c2c;
            transition: background-color 0.3s;
        }
        .email-container:hover {
            background-color: #f0f0f0;
            color: #333;
        }
        .email-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
            color: #aaa;
            margin-bottom: 10px;
        }
        .email-container:hover .email-header span,
        .email-container:hover .email-header strong {
            color: #555;
        }
        .email-subject {
            font-weight: bold;
            color: var(--primary-color);
            margin: 0;
        }
        .email-container:hover .email-subject {
            color: #333;
        }
        .email-body {
            font-size: 1em;
            margin-top: 10px;
        }
        .email-link {
            color: var(--primary-color);
            text-decoration: underline;
        }
        .question-box {
            background-color: #2c2c2c;
            border: 1px solid var(--border-color);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: left;
            transition: background-color 0.3s;
        }
        .question-box:hover {
            background-color: #f0f0f0;
            color: #333;
        }
        .question-box p {
            margin-top: 0;
            margin-bottom: 10px;
            font-weight: 500;
        }
        .question-box:hover p {
            color: #333;
        }
        .question-box label {
            display: block;
            margin-bottom: 5px;
            cursor: pointer;
        }
        .glossary-item {
            background-color: #2c2c2c;
            border: 1px solid var(--border-color);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: left;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .glossary-item:hover {
            background-color: #f0f0f0;
        }
        .glossary-term-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .glossary-item:hover .glossary-term-header h3 {
            color: #333;
        }
        .glossary-item:hover .glossary-definition p {
            color: #555;
        }
        .glossary-term-header h3 {
            margin: 0;
            color: var(--secondary-color);
            font-size: 1.2em;
            font-weight: 600;
        }
        .glossary-term-header .arrow {
            font-size: 1.5em;
            transition: transform 0.3s;
        }
        .glossary-item.active .arrow {
            transform: rotate(90deg);
        }
        .glossary-definition {
            display: none;
            padding-top: 10px;
            margin-top: 10px;
            border-top: 1px solid var(--border-color);
        }
        .glossary-item.active .glossary-definition {
            display: block;
        }
        .filter-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        .filter-controls label, .filter-controls select {
            font-size: 1em;
            color: #ccc;
        }
        .filter-controls select {
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #555;
            background-color: #333;
            color: #ccc;
            transition: background-color 0.3s, color 0.3s;
        }
        .filter-controls select:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--primary-color);
        }
        .tool-box h2 {
            cursor: pointer;
        }
        .tool-box h2:hover {
            color: var(--primary-color);
        }

        /* NEW STYLE */
        .password-container {
            position: relative;
            margin-bottom: 15px;
        }
        .password-container input {
            padding-right: 40px; /* Adjust padding to make space for the icon */
            margin-bottom: 0;
        }
        .password-container .toggle-password {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #555;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo-container">
            <img src="logo.png" alt="Logo de CiberSeg" class="logo">
        </div>
        <header>
            <h1 id="main-title">Bienvenido a CiberSeg</h1>
        </header>

        <section id="login-section" class="section">
            <h2>Acceso al Sistema</h2>
            <div class="login-box">
                <form id="login-form">
                    <input type="text" id="username" placeholder="Usuario" required>
                    <div class="password-container">
                        <input type="password" id="password" placeholder="Contrase√±a" required>
                        <span class="toggle-password" onclick="togglePasswordVisibility('password', this)">üëÅÔ∏è</span>
                    </div>
                    <button type="submit" class="button-submit">Iniciar Sesi√≥n</button>
                </form>
            </div>
            <button class="button-secondary" onclick="showSection('register-section')">Registrarse</button>
        </section>

        <section id="register-section" class="section hidden">
            <h2>Registro de Usuario</h2>
            <div class="form-box">
                <form id="register-form">
                    <input type="text" id="reg-name" placeholder="Nombre completo" required>
                    <input type="email" id="reg-email" placeholder="Correo electr√≥nico" required>
                    <input type="number" id="reg-age" placeholder="Edad" min="1" required>
                    <select id="reg-country" required>
                        <option value="">Seleccione su pa√≠s</option>
                        <optgroup label="Guatemala">
                            <option value="Guatemala">Guatemala</option>
                        </optgroup>
                        <optgroup label="Centroam√©rica">
                            <option value="Belice">Belice</option>
                            <option value="El Salvador">El Salvador</option>
                            <option value="Honduras">Honduras</option>
                            <option value="Nicaragua">Nicaragua</option>
                            <option value="Costa Rica">Costa Rica</option>
                            <option value="Panam√°">Panam√°</option>
                        </optgroup>
                    </select>
                    <button type="submit" class="button-submit">Registrar y Acceder</button>
                </form>
            </div>
            <button class="button-secondary" onclick="showSection('login-section')">Volver</button>
        </section>

        <section id="user-menu-section" class="section hidden">
            <div class="tool-cards-container">
                <div class="tool-card" onclick="showTool('quiz-tool')">
                    <h3>Diagn√≥stico de Riesgo</h3>
                    <p>Eval√∫a tus h√°bitos de seguridad digital.</p>
                </div>
                <div class="tool-card" onclick="showTool('phishing-tool')">
                    <h3>Simulador de Phishing</h3>
                    <p>Aprende a identificar correos fraudulentos.</p>
                </div>
                <div class="tool-card" onclick="showTool('password-tool')">
                    <h3>Evaluaci√≥n de Contrase√±as</h3>
                    <p>Verifica qu√© tan fuerte es tu contrase√±a.</p>
                </div>
                <div class="tool-card" onclick="showTool('glossary-tool')">
                    <h3>Glosario</h3>
                    <p>Descubre los t√©rminos clave de ciberseguridad.</p>
                </div>
            </div>

            <div id="quiz-tool" class="tool-box hidden">
                <h2>Diagn√≥stico de Riesgo</h2>
                <p>Responde estas preguntas para evaluar tus h√°bitos de seguridad digital.</p>
                <form id="quiz-form"></form>
                <button id="quiz-submit" class="button-submit">Ver Diagn√≥stico</button>
                <button class="button-secondary" onclick="showUserMenu()">Volver al Men√∫ Principal</button>
            </div>

            <div id="phishing-tool" class="tool-box hidden">
                <h2>Simulador de Phishing</h2>
                <p>¬°Atenci√≥n! A continuaci√≥n, se muestran tres correos electr√≥nicos. **Tu tarea es identificar el √∫nico correo seguro.** Los otros dos son intentos de phishing. Selecciona la opci√≥n que consideres correcta.</p>
                <div id="phishing-emails-container"></div>
                <button class="button-secondary" onclick="showUserMenu()">Volver al Men√∫ Principal</button>
            </div>

            <div id="password-tool" class="tool-box hidden">
                <h2>Evaluaci√≥n de Contrase√±as</h2>
                <p>Una contrase√±a segura es clave para proteger tus datos. Aseg√∫rate de que tenga al menos 8 caracteres, e incluya una combinaci√≥n de letras may√∫sculas, min√∫sculas, n√∫meros y s√≠mbolos.</p>
                <p>Ingresa una contrase√±a para ver su nivel de complejidad y seguridad.</p>
                <div class="password-container">
                    <input type="password" id="password-input" placeholder="Escribe aqu√≠ tu contrase√±a" oninput="evaluatePassword()">
                    <span class="toggle-password" onclick="togglePasswordVisibility('password-input', this)">üëÅÔ∏è</span>
                </div>
                <p id="password-strength">Tu contrase√±a es: **D√©bil**</p>

                <hr style="margin-top: 25px; margin-bottom: 25px; border-color: #555;">

                <h2>Generador de Contrase√±as Seguras</h2>
                <p>Genera una contrase√±a aleatoria y segura para tus cuentas.</p>
                <div class="form-box">
                    <button class="button-submit" onclick="generateSecurePassword()">Generar Contrase√±a Segura</button>
                    <input type="text" id="generated-password" readonly placeholder="Contrase√±a generada aparecer√° aqu√≠...">
                </div>
                <p>Usa esta herramienta para crear contrase√±as √∫nicas que sean dif√≠ciles de adivinar.</p>
                <button class="button-secondary" onclick="showUserMenu()">Volver al Men√∫ Principal</button>
            </div>

            <div id="glossary-tool" class="tool-box hidden">
                <h2>Glosario de Ciberseguridad</h2>
                <p>Aqu√≠ encontrar√°s definiciones sencillas para los t√©rminos m√°s comunes en ciberseguridad.</p>
                <div id="glossary-container"></div>
                <button class="button-secondary" onclick="showUserMenu()">Volver al Men√∫ Principal</button>
            </div>

            <button class="button-secondary" onclick="showSection('login-section')">Cerrar Sesi√≥n</button>
        </section>

        <section id="admin-dashboard" class="section hidden">
            <h2>Panel de Administrador</h2>
            <div class="admin-dashboard">
                <div class="metric-card">
                    <h3>Usuarios Registrados</h3>
                    <p class="value" id="users-registered">0</p>
                </div>
                <div class="metric-card">
                    <h3>Ataques de Phishing Bloqueados</h3>
                    <p class="value" id="phishing-blocked">1,540</p>
                </div>
                <div class="metric-card">
                    <h3>Puntaje de Riesgo Promedio</h3>
                    <p class="value" id="avg-risk-score">82%</p>
                </div>
                <div class="chart-container">
                    <h3>Tendencias de Riesgo</h3>
                    <div class="chart-placeholder">
                        <img src="tendencias_de_riesgo.png" alt="Gr√°fico de Tendencias de Riesgo">
                    </div>
                </div>
                <div class="chart-container">
                    <h3>Distribuci√≥n Geogr√°fica (Imagen)</h3>
                    <div class="chart-placeholder">
                        <img src="distribucion_geografica.png" alt="Gr√°fico de Distribuci√≥n Geogr√°fica">
                    </div>
                </div>
                <div class="chart-container">
                    <h3>Distribuci√≥n Geogr√°fica (Gr√°fico interactivo)</h3>
                    <div class="chart-placeholder">
                        <canvas id="geo-distribution-chart"></canvas>
                    </div>
                </div>
            </div>

            <div class="section-box">
                <h3>Informaci√≥n de Usuarios</h3>
                <div class="filter-controls">
                    <label for="quiz-filter">Diagn√≥stico de Riesgo:</label>
                    <select id="quiz-filter" onchange="renderUserTable()">
                        <option value="all">Todos</option>
                        <option value="approved">Aprobados</option>
                        <option value="failed">Reprobados</option>
                    </select>
                    <label for="phishing-filter">Simulador de Phishing:</label>
                    <select id="phishing-filter" onchange="renderUserTable()">
                        <option value="all">Todos</option>
                        <option value="passed">Superado</option>
                        <option value="failed">Fallido</option>
                    </select>
                    <label for="country-filter">Pa√≠s:</label>
                    <select id="country-filter" onchange="renderUserTable()">
                        <option value="all">Todos</option>
                        <option value="Guatemala">Guatemala</option>
                        <option value="Belice">Belice</option>
                        <option value="El Salvador">El Salvador</option>
                        <option value="Honduras">Honduras</option>
                        <option value="Nicaragua">Nicaragua</option>
                        <option value="Costa Rica">Costa Rica</option>
                        <option value="Panam√°">Panam√°</option>
                    </select>
                </div>
                <table class="user-table">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Edad</th>
                            <th>Correo</th>
                            <th>Pa√≠s</th>
                            <th>Diagn√≥stico de Riesgo</th>
                            <th>Resultado de Phishing</th>
                        </tr>
                    </thead>
                    <tbody id="user-table-body">
                    </tbody>
                </table>
            </div>

            <button class="button-secondary" onclick="showSection('login-section')">Cerrar Sesi√≥n</button>
        </section>
    </div>

    <div id="resultModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal()">&times;</span>
            <h2 id="modal-title"></h2>
            <div id="modal-body"></div>
            <button class="button-secondary" onclick="closeModal()">Cerrar</button>
        </div>
    </div>

    <script>
        let userName = '';
        let currentUserIndex = -1;
        const sections = document.querySelectorAll('.section');
        const users = [
            { name: 'Sof√≠a Garc√≠a', age: 25, email: 'sofia.garcia@gmail.com', country: 'Guatemala', quizScore: 85, phishingResult: true },
            { name: 'Juan P√©rez', age: 32, email: 'juan.perez@hotmail.com', country: 'El Salvador', quizScore: 40, phishingResult: false },
            { name: 'Ana Torres', age: 45, email: 'ana.torres@yahoo.com', country: 'Honduras', quizScore: 95, phishingResult: true },
            { name: 'Luis Ramos', age: 28, email: 'luis.ramos@outlook.com', country: 'Guatemala', quizScore: 60, phishingResult: false },
            { name: 'Mariana Cruz', age: 22, email: 'mariana.cruz@gmail.com', country: 'Costa Rica', quizScore: 78, phishingResult: true },
            { name: 'Carlos D√≠az', age: 35, email: 'carlos.diaz@gmail.com', country: 'Guatemala', quizScore: 90, phishingResult: true },
            { name: 'Laura Mendoza', age: 29, email: 'laura.mendoza@outlook.com', country: 'Nicaragua', quizScore: null, phishingResult: null },
            { name: 'Pedro Sol√≠s', age: 41, email: 'pedro.solis@hotmail.com', country: 'El Salvador', quizScore: 88, phishingResult: false },
            { name: 'Gabriela Soto', age: 24, email: 'gabriela.soto@yahoo.com', country: 'Panam√°', quizScore: null, phishingResult: null },
            { name: 'Jorge Castro', age: 38, email: 'jorge.castro@gmail.com', country: 'Belice', quizScore: 75, phishingResult: true }
        ];

        const quizQuestions = [
            {
                q: '¬øUtilizas la misma contrase√±a para m√∫ltiples cuentas importantes?',
                options: [
                    {text: 'No, uso contrase√±as √∫nicas.', value: 0},
                    {text: 'A veces, para algunas cuentas.', value: 5},
                    {text: 'S√≠, casi siempre la misma.', value: 10}
                ]
            },
            {
                q: '¬øHaces copias de seguridad de tus archivos importantes?',
                options: [
                    {text: 'S√≠, regularmente.', value: 0},
                    {text: 'A veces.', value: 5},
                    {text: 'No, nunca.', value: 10}
                ]
            },
            {
                q: '¬øRevisas los enlaces de correos o mensajes antes de hacer clic?',
                options: [
                    {text: 'S√≠, siempre verifico.', value: 0},
                    {text: 'A veces, si es sospechoso.', value: 5},
                    {text: 'No, hago clic sin pensar.', value: 10}
                ]
            },
            {
                q: '¬øTienes un antivirus o antimalware activo en tus dispositivos?',
                options: [
                    {text: 'S√≠, y est√° actualizado.', value: 0},
                    {text: 'A veces, pero no lo actualizo.', value: 5},
                    {text: 'No, no uso ninguno.', value: 10}
                ]
            },
            {
                q: '¬øTienes activada la autenticaci√≥n de dos factores (2FA) en tus cuentas principales?',
                options: [
                    {text: 'S√≠, en la mayor√≠a.', value: 0},
                    {text: 'En algunas cuentas importantes.', value: 5},
                    {text: 'No, en ninguna.', value: 10}
                ]
            },
            {
                q: '¬øEres consciente de los peligros de las redes Wi-Fi p√∫blicas no seguras?',
                options: [
                    {text: 'S√≠, y no realizo transacciones bancarias en ellas.', value: 0},
                    {text: 'Lo he escuchado, pero no me preocupo mucho.', value: 5},
                    {text: 'No, nunca lo hab√≠a pensado.', value: 10}
                ]
            },
            {
                q: '¬øVerificas regularmente los permisos que otorgan las aplicaciones que instalas?',
                options: [
                    {text: 'S√≠, solo les doy los permisos esenciales.', value: 0},
                    {text: 'A veces.', value: 5},
                    {text: 'No, nunca reviso los permisos.', value: 10}
                ]
            },
            {
                q: '¬øActualizas regularmente el software de tus dispositivos (sistema operativo, aplicaciones)?',
                options: [
                    {text: 'S√≠, tan pronto como hay una actualizaci√≥n disponible.', value: 0},
                    {text: 'De vez en cuando.', value: 5},
                    {text: 'No, prefiero no actualizar.', value: 10}
                ]
            },
            {
                q: '¬øCompartes informaci√≥n personal (como tu fecha de nacimiento o lugar de trabajo) en redes sociales con perfiles p√∫blicos?',
                options: [
                    {text: 'No, mantengo mi perfil privado.', value: 0},
                    {text: 'Solo con amigos cercanos.', value: 5},
                    {text: 'S√≠, comparto mucha informaci√≥n personal.', value: 10}
                ]
            },
            {
                q: 'Si recibes una llamada de un banco solicitando tu n√∫mero de cuenta o PIN, ¬øqu√© haces?',
                options: [
                    {text: 'Cuelgo y llamo al n√∫mero oficial del banco para verificar.', value: 0},
                    {text: 'Les doy la informaci√≥n que me piden si la llamada parece leg√≠tima.', value: 10},
                    {text: 'Les digo que no estoy interesado.', value: 5}
                ]
            }
        ];

        // Lista de correos con m√°s ejemplos, incluyendo leg√≠timos
        const phishingEmails = [
            {
                sender: 'Netflix Support &lt;soporte@netflx-pago.com&gt;',
                subject: 'Facturaci√≥n: Tu pago ha fallado. ¬°Acci√≥n requerida!',
                body: '<p>Hola usuario,</p><p>Lamentamos informarte que tu pago reciente no ha podido ser procesado. Para evitar la suspensi√≥n de tu servicio y seguir disfrutando de tus series y pel√≠culas, por favor actualiza tu informaci√≥n de pago a trav√©s de este enlace:</p><p><a href="#" class="email-link">**Actualizar mi informaci√≥n de pago**</a></p><p>Gracias por tu comprensi√≥n.</p>',
                isSafe: false
            },
            {
                sender: 'Notificaciones CiberSeg &lt;info@ciberseg.com&gt;',
                subject: 'Tu reporte semanal de seguridad digital',
                body: '<p>Hola,</p><p>Esperamos que te encuentres bien. Tu reporte semanal de buenas pr√°cticas de seguridad ya est√° disponible. Accede a tu panel para ver tus estad√≠sticas y recomendaciones personalizadas.</p><p><a href="#" class="email-link">Acceder a mi panel de CiberSeg</a></p><p>Te recordamos que no necesitas responder a este correo.</p>',
                isSafe: true
            },
            {
                sender: 'Banco Seguridad &lt;alerta@seguridad-banco.net&gt;',
                subject: 'Alerta de Seguridad: Su cuenta ha sido suspendida',
                body: '<p>Estimado cliente,</p><p>Hemos detectado una actividad sospechosa en su cuenta. Para evitar un fraude y reactivarla, necesitamos que verifique su identidad de inmediato. Haga clic en el siguiente enlace y complete el formulario con sus datos personales y credenciales.</p><p><a href="#" class="email-link">**Verificar mi identidad y reactivar mi cuenta**</a></p><p>Por su seguridad, si no lo hace en 24 horas, su cuenta ser√° cerrada permanentemente.</p>',
                isSafe: false
            },
            {
                sender: 'Soporte Microsoft &lt;support@m1crosoft-security.info&gt;',
                subject: 'Advertencia Cr√≠tica: Su cuenta de Microsoft ha sido comprometida',
                body: '<p>Estimado/a usuario/a,</p><p>Se ha intentado acceder a su cuenta desde una ubicaci√≥n no reconocida. Para evitar el bloqueo permanente de su cuenta, le pedimos que inicie sesi√≥n y actualice su informaci√≥n de seguridad de inmediato. El no hacerlo resultar√° en la p√©rdida total de acceso a sus datos.</p><p><a href="#" class="email-link">**Actualizar Ahora**</a></p><p>Gracias por su pronta atenci√≥n.</p>',
                isSafe: false
            },
            {
                sender: 'Google Support &lt;no-reply@google.com&gt;',
                subject: 'Revisa tu actividad de inicio de sesi√≥n reciente',
                body: '<p>Hola,</p><p>Se ha iniciado sesi√≥n en tu cuenta de Google en un nuevo dispositivo. Si has sido t√∫, no necesitas hacer nada. Si no has sido t√∫, revisa tu actividad de seguridad para proteger tu cuenta.</p><p><a href="#" class="email-link">Revisar actividad</a></p><p>Gracias,<br>El equipo de Cuentas de Google</p>',
                isSafe: true
            },
            {
                sender: 'PayPal Service &lt;serviciocliente@paypal.com-seguro.com&gt;',
                subject: '¬°Alerta de Reembolso! Ha recibido un pago de $500',
                body: '<p>Felicitaciones,</p><p>Ha recibido un pago de $500.00 USD. Para aceptar su reembolso, haga clic en el enlace a continuaci√≥n y verifique su informaci√≥n bancaria. Le pedimos que act√∫e de inmediato, ya que este reembolso expirar√° en 24 horas.</p><p><a href="#" class="email-link">**Reclamar mi Reembolso**</a></p>',
                isSafe: false
            },
            {
                sender: 'Amazon Alerts &lt;alerta@amazon-online.net&gt;',
                subject: 'Confirmaci√≥n de Pedido: MacBook Pro',
                body: '<p>Hola [Tu nombre],</p><p>Queremos confirmar tu pedido reciente de un MacBook Pro por valor de Q15,000. If you have not made this purchase, please click on the link below to cancel the transaction and confirm your account:</p><p><a href="#" class="email-link">**Cancelar y proteger mi cuenta**</a></p><p>Thanks for your attention.</p>',
                isSafe: false
            },
            {
                sender: 'Spotify &lt;no-reply@spotify.com&gt;',
                subject: 'Informaci√≥n sobre tu cuenta de Spotify',
                body: '<p>Hola,</p><p>Este es un recordatorio de que tu suscripci√≥n premium se renovar√° el 1 de octubre. Si deseas actualizar tu m√©todo de pago o cancelar tu suscripci√≥n, visita tu p√°gina de configuraci√≥n de cuenta.</p><p>Saludos cordiales,<br>El equipo de Spotify</p>',
                isSafe: true
            },
            {
                sender: 'Apple Support &lt;noreply@icloud.com-id.com&gt;',
                subject: 'Tu ID de Apple ha sido bloqueado por seguridad',
                body: '<p>Tu ID de Apple ha sido temporalmente bloqueado por motivos de seguridad debido a m√∫ltiples intentos de inicio de sesi√≥n fallidos.</p><p>Para desbloquear tu cuenta y verificar tu identidad, por favor haz clic en el siguiente enlace y proporciona tu informaci√≥n personal:</p><p><a href="#" class="email-link">**Desbloquear ahora**</a></p><p>Saludos,<br>Soporte de Apple</p>',
                isSafe: false
            },
            {
                sender: 'Soporte del Banco &lt;notificaciones@bancocentral.com&gt;',
                subject: 'Verificaci√≥n de Seguridad',
                body: '<p>Estimado Cliente,</p><p>Como parte de nuestras medidas de seguridad, estamos actualizando la informaci√≥n de nuestros usuarios. Por favor, inicie sesi√≥n en nuestro sitio web oficial o visite su sucursal m√°s cercana para verificar su cuenta. Nunca le pediremos su informaci√≥n personal por correo electr√≥nico.</p><p>Gracias por su colaboraci√≥n.</p>',
                isSafe: true
            },
            {
                sender: 'Promociones de Premios &lt;premios@gana-ya.xyz&gt;',
                subject: '¬°Felicidades! Has ganado un iPhone 15.',
                body: '<p>¬°Incre√≠ble! Has sido seleccionado como ganador de nuestro sorteo anual. Para reclamar tu premio, por favor haz clic en el enlace a continuaci√≥n y completa tus datos de env√≠o y pago para cubrir los "gastos de manejo".</p><p><a href="#" class="email-link">**Reclamar mi premio**</a></p>',
                isSafe: false
            }
        ];

        const glossaryTerms = [
            {
                term: 'Phishing',
                definition: 'Es cuando un estafador se hace pasar por una persona o empresa de confianza (como tu banco) para robar tu informaci√≥n personal, como contrase√±as o datos de tarjetas de cr√©dito. Usualmente llega por correo, mensaje o llamada.'
            },
            {
                term: 'Malware',
                definition: 'Es cualquier software malicioso que se instala en tu dispositivo sin tu permiso. Su objetivo es da√±arlo o robar tu informaci√≥n. Algunos ejemplos son los virus, troyanos y spyware.'
            },
            {
                term: 'Contrase√±a segura',
                definition: 'Es una combinaci√≥n de al menos 8 a 12 caracteres, que incluye letras (may√∫sculas y min√∫sculas), n√∫meros y s√≠mbolos. Es √∫nica para cada cuenta y dif√≠cil de adivinar o descifrar.'
            },
            {
                term: 'Autenticaci√≥n de dos factores (2FA)',
                definition: 'Es una capa extra de seguridad. Despu√©s de ingresar tu contrase√±a, se te pide un segundo dato para confirmar que eres t√∫, como un c√≥digo que llega a tu tel√©fono o un dato biom√©trico (huella digital o rostro).'
            },
            {
                term: 'Antivirus',
                definition: 'Es un programa que detecta, previene y elimina el malware (programas maliciosos) de tu computadora, tel√©fono o tablet.'
            },
            {
                term: 'Ransomware',
                definition: 'Es un tipo de ataque cibern√©tico donde los criminales "secuestran" tus archivos o tu computadora, encript√°ndolos (haci√©ndolos ilegibles). Luego te piden un rescate (dinero) a cambio de devolverte el acceso.'
            },
            {
                term: 'Ciberseguridad',
                definition: 'Es la pr√°ctica de proteger los sistemas, las redes y los programas de los ataques digitales. Su objetivo es evitar que se robe informaci√≥n, se da√±en los equipos o se interrumpan servicios importantes.'
            },
            {
                term: 'Firewall',
                definition: 'Funciona como un muro de protecci√≥n entre tu red y el internet, bloqueando el tr√°fico que parece peligroso para prevenir que entren ataques a tu computadora.'
            },
            {
                term: 'Ingenier√≠a social',
                definition: 'Es el arte de manipular a las personas para que revelen informaci√≥n confidencial o hagan algo que no deber√≠an. El phishing es un ejemplo muy com√∫n de este tipo de enga√±o.'
            },
            {
                term: 'Virus',
                definition: 'Es un tipo de malware que se adjunta a un programa o archivo, y cuando lo abres, se copia y se esparce por todo tu sistema, da√±ando otros archivos.'
            },
            {
                term: 'Troyano',
                definition: 'Es un malware que se disfraza de un programa √∫til o inofensivo, pero por detr√°s, le da a un atacante acceso a tu dispositivo para robar tu informaci√≥n.'
            },
            {
                term: 'Denegaci√≥n de Servicio (DoS)',
                definition: 'Es un ataque que busca sobrecargar un servidor o sitio web con tanto tr√°fico falso que el servicio se cae y no puede atender a los usuarios reales.'
            },
            {
                term: 'VPN (Red Privada Virtual)',
                definition: 'Es una herramienta que te permite navegar por internet de forma segura y an√≥nima. Oculta tu direcci√≥n IP y encripta tu conexi√≥n, protegi√©ndote de los riesgos en redes Wi-Fi p√∫blicas.'
            },
            {
                term: 'Zero-Day',
                definition: 'Se refiere a una vulnerabilidad o falla en un programa que a√∫n no es conocida por los desarrolladores. Esto la hace muy peligrosa porque no hay un parche o soluci√≥n disponible para protegerse.'
            },
            {
                term: 'Ataque de fuerza bruta',
                definition: 'Es un m√©todo en el que un programa intenta adivinar una contrase√±a probando millones de combinaciones de caracteres por segundo, hasta que encuentra la correcta.'
            },
            {
                term: 'Malvertising',
                definition: 'Es la pr√°ctica de usar anuncios en l√≠nea para distribuir malware. Si haces clic en un anuncio malicioso, puedes descargar un programa da√±ino sin darte cuenta.'
            }
        ];

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function renderUserTable() {
            const quizFilter = document.getElementById('quiz-filter').value;
            const phishingFilter = document.getElementById('phishing-filter').value;
            const countryFilter = document.getElementById('country-filter').value;
            let filteredUsers = users;

            if (quizFilter !== 'all') {
                filteredUsers = filteredUsers.filter(user => {
                    if (quizFilter === 'approved') {
                        return user.quizScore !== null && user.quizScore >= 80;
                    } else if (quizFilter === 'failed') {
                        return user.quizScore !== null && user.quizScore < 80;
                    }
                    return true;
                });
            }

            if (phishingFilter !== 'all') {
                filteredUsers = filteredUsers.filter(user => {
                    if (phishingFilter === 'passed') {
                        return user.phishingResult === true;
                    } else if (phishingFilter === 'failed') {
                        return user.phishingResult === false;
                    }
                    return true;
                });
            }

            if (countryFilter !== 'all') {
                filteredUsers = filteredUsers.filter(user => user.country === countryFilter);
            }

            const tableBody = document.getElementById('user-table-body');
            tableBody.innerHTML = '';
            filteredUsers.forEach(user => {
                const row = document.createElement('tr');
                const quizScoreCell = user.quizScore !== null ? `<td style="color: ${user.quizScore >= 80 ? 'var(--green-score)' : 'var(--red-score)'}; font-weight: bold;">${user.quizScore}%</td>` : `<td>N/A</td>`;
                const phishingResultCell = user.phishingResult !== null ? `<td style="color: ${user.phishingResult ? 'var(--green-score)' : 'var(--red-score)'}; font-weight: bold;">${user.phishingResult ? 'Superado' : 'Fallido'}</td>` : `<td>N/A</td>`;

                row.innerHTML = `
                    <td>${user.name}</td>
                    <td>${user.age}</td>
                    <td>${user.email}</td>
                    <td>${user.country}</td>
                    ${quizScoreCell}
                    ${phishingResultCell}
                `;
                tableBody.appendChild(row);
            });
            document.getElementById('users-registered').textContent = `${users.length} usuarios`;

            // Actualizar el color de fondo de los selects
            document.querySelectorAll('.filter-controls select').forEach(select => {
                if (select.value !== 'all') {
                    select.style.backgroundColor = '#fff';
                    select.style.color = '#333';
                } else {
                    select.style.backgroundColor = '#333';
                    select.style.color = '#ccc';
                }
            });
        }

        function loadQuiz() {
            const quizForm = document.getElementById('quiz-form');
            quizForm.innerHTML = '';
            const selectedQuestions = shuffle(quizQuestions).slice(0, 8);
            selectedQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-box';
                questionDiv.innerHTML = `<p>${index + 1}. ${q.q}</p>`;
                q.options.forEach(opt => {
                    questionDiv.innerHTML += `<label><input type="radio" name="q${index}" value="${opt.value}"> ${opt.text}</label>`;
                });
                quizForm.appendChild(questionDiv);
            });
        }

        function loadPhishingTest() {
            const container = document.getElementById('phishing-emails-container');
            container.innerHTML = '';
            const allEmails = [...phishingEmails];
            const safeEmails = allEmails.filter(email => email.isSafe);
            const unsafeEmails = allEmails.filter(email => !email.isSafe);

            const selectedSafe = shuffle(safeEmails).slice(0, 1);
            const selectedUnsafe = shuffle(unsafeEmails).slice(0, 2);

            const selectedEmails = shuffle([...selectedSafe, ...selectedUnsafe]);

            selectedEmails.forEach(email => {
                const emailDiv = document.createElement('div');
                emailDiv.className = 'email-container';
                emailDiv.setAttribute('onclick', `showPhishingResult(${email.isSafe})`);
                emailDiv.innerHTML = `
                    <div class="email-header">
                        <span>De: <strong>${email.sender}</strong></span>
                        <span>Hoy, ${new Date().toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' })}</span>
                    </div>
                    <p class="email-subject">${email.subject}</p>
                    <hr>
                    <div class="email-body">${email.body}</div>
                `;
                container.appendChild(emailDiv);
            });
        }

        function loadGlossary() {
            const glossaryContainer = document.getElementById('glossary-container');
            glossaryContainer.innerHTML = '';
            glossaryTerms.forEach(term => {
                const termDiv = document.createElement('div');
                termDiv.className = 'glossary-item';
                termDiv.innerHTML = `
                    <div class="glossary-term-header">
                        <h3>${term.term}</h3>
                        <span class="arrow">‚ñ∫</span>
                    </div>
                    <div class="glossary-definition">
                        <p>${term.definition}</p>
                    </div>
                `;
                termDiv.addEventListener('click', function() {
                    this.classList.toggle('active');
                });
                glossaryContainer.appendChild(termDiv);
            });
        }

        function showSection(sectionId) {
            sections.forEach(section => {
                section.classList.remove('active');
                section.classList.add('hidden');
            });
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.remove('hidden');
                setTimeout(() => {
                    section.classList.add('active');
                }, 10);
            }

            if (sectionId === 'admin-dashboard') {
                renderAdminMetrics();
                renderUserTable();
                renderCharts();
            }
        }

        function showTool(toolId) {
            const allTools = document.querySelectorAll('#user-menu-section .tool-box');
            allTools.forEach(tool => {
                tool.classList.add('hidden');
            });

            const toolCardsContainer = document.querySelector('.tool-cards-container');
            if (toolCardsContainer) {
                toolCardsContainer.classList.add('hidden');
            }

            const toolToShow = document.getElementById(toolId);
            if (toolToShow) {
                toolToShow.classList.remove('hidden');
            }

            if (toolId === 'quiz-tool') {
                loadQuiz();
            } else if (toolId === 'phishing-tool') {
                loadPhishingTest();
            } else if (toolId === 'glossary-tool') {
                loadGlossary();
            }
        }

        function showUserMenu() {
            const allTools = document.querySelectorAll('#user-menu-section .tool-box');
            allTools.forEach(tool => {
                tool.classList.add('hidden');
            });
            const toolCardsContainer = document.querySelector('.tool-cards-container');
            if (toolCardsContainer) {
                toolCardsContainer.classList.remove('hidden');
            }
        }

        function showModal(title, content) {
            const modal = document.getElementById('resultModal');
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-body').innerHTML = content;
            modal.classList.add('show');
        }
        function closeModal() {
            const modal = document.getElementById('resultModal');
            modal.classList.remove('show');
        }

        document.getElementById('login-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            if (username === 'admin' && password === 'admin123') {
                showSection('admin-dashboard');
                document.getElementById('main-title').textContent = 'Panel de Administrador';
            } else if (username === 'usuario' && password === 'test1234') {
                showSection('user-menu-section');
                document.getElementById('main-title').textContent = 'Herramientas de Ciberseguridad';
            } else {
                alert('Usuario o contrase√±a incorrectos.');
            }
        });

        document.getElementById('register-form').addEventListener('submit', function(event) {
            event.preventDefault();
            const regName = document.getElementById('reg-name').value;
            const regEmail = document.getElementById('reg-email').value;
            const regAge = document.getElementById('reg-age').value;
            const regCountry = document.getElementById('reg-country').value;

            const isEmailRegistered = users.some(user => user.email === regEmail);
            if (isEmailRegistered) {
                alert('El correo electr√≥nico ya est√° registrado. Por favor, utiliza otro.');
                return;
            }

            const newUser = {
                name: regName,
                age: parseInt(regAge),
                email: regEmail,
                country: regCountry,
                quizScore: null,
                phishingResult: null
            };
            users.push(newUser);
            currentUserIndex = users.length - 1;
            userName = newUser.name;

            unifyInputColors();

            alert(`¬°Hola, ${userName}! Tu registro ha sido completado. Ser√°s redirigido al men√∫ de herramientas.`);
            showSection('user-menu-section');
        });

        function unifyInputColors() {
            const inputs = document.querySelectorAll('#register-section input, #register-section select');
            inputs.forEach(input => {
                if (input.value !== '') {
                    input.style.backgroundColor = 'var(--secondary-color)';
                }
            });
        }

        document.getElementById('quiz-submit').addEventListener('click', function() {
            let score = 0;
            const questions = document.getElementById('quiz-form').querySelectorAll('.question-box');
            let allAnswered = true;

            questions.forEach(q => {
                const selected = q.querySelector('input[type="radio"]:checked');
                if (selected) {
                    score += parseInt(selected.value);
                } else {
                    allAnswered = false;
                }
            });

            if (!allAnswered) {
                alert('Por favor, responde todas las preguntas del diagn√≥stico.');
                return;
            }

            const maxScore = questions.length * 10;
            const percentage = ((maxScore - score) / maxScore) * 100;

            if (currentUserIndex !== -1) {
                users[currentUserIndex].quizScore = percentage.toFixed(0);
            }

            const content = `
                <p>Hola, <strong>${userName}</strong>.</p>
                <p>Tu puntaje en el Diagn√≥stico de Riesgo es:</p>
                <p class="quiz-result-percentage ${percentage >= 80 ? 'green-score' : 'red-score'}">${percentage.toFixed(0)}%</p>
                <p>${percentage >= 80 ? '¬°Felicidades! Tienes un excelente nivel de conocimiento en ciberseguridad.' : '¬°Hay mucho por mejorar! Te recomendamos explorar nuestras herramientas y servicios.'}</p>
            `;
            showModal('Resultados del Diagn√≥stico', content);
        });

        function showPhishingResult(isCorrect) {
            if (currentUserIndex !== -1) {
                users[currentUserIndex].phishingResult = isCorrect;
            }

            let content = '';
            if (isCorrect) {
                content = `<p class="result-level high-risk">¬°Correcto!</p><p>Has identificado el correo seguro. ¬°Excelente trabajo!</p>`;
            } else {
                content = `<p class="result-level low-risk">¬°Incorrecto!</p><p>Ese era un intento de phishing. Te recomendamos analizar siempre la direcci√≥n de correo y los enlaces antes de hacer clic.</p>`;
            }
            showModal('Resultado del Simulador de Phishing', content);
        }

        function evaluatePassword() {
            const password = document.getElementById('password-input').value;
            let strength = 'Muy d√©bil';
            let strengthColor = 'red';

            const hasLowercase = /[a-z]/.test(password);
            const hasUppercase = /[A-Z]/.test(password);
            const hasNumber = /[0-9]/.test(password);
            const hasSpecial = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~`]/.test(password);
            const isLong = password.length >= 8;

            let score = 0;
            if (isLong) score++;
            if (hasLowercase) score++;
            if (hasUppercase) score++;
            if (hasNumber) score++;
            if (hasSpecial) score++;

            if (score >= 5) {
                strength = 'Muy Fuerte';
                strengthColor = 'var(--green-score)';
            } else if (score >= 3) {
                strength = 'Fuerte';
                strengthColor = '#ffc107';
            } else if (score >= 1) {
                strength = 'D√©bil';
                strengthColor = 'var(--red-score)';
            }

            const passwordStrengthElement = document.getElementById('password-strength');
            passwordStrengthElement.textContent = `Tu contrase√±a es: **${strength}**`;
            passwordStrengthElement.style.color = strengthColor;
        }

        function generateSecurePassword() {
            const length = 16;
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+=-{}[]|:;"<>,.?/~`';
            let password = '';
            for (let i = 0; i < length; i++) {
                password += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            document.getElementById('generated-password').value = password;
        }

        function togglePasswordVisibility(id, icon) {
            const passwordInput = document.getElementById(id);
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                icon.textContent = 'üôà';
            } else {
                passwordInput.type = 'password';
                icon.textContent = 'üëÅÔ∏è';
            }
        }

        function renderAdminMetrics() {
            document.getElementById('users-registered').textContent = users.length;
            const avgScore = users.filter(u => u.quizScore !== null).reduce((sum, u) => sum + u.quizScore, 0) / users.filter(u => u.quizScore !== null).length;
            document.getElementById('avg-risk-score').textContent = avgScore ? `${avgScore.toFixed(0)}%` : 'N/A';
        }

        function renderCharts() {
            // Eliminar gr√°ficos existentes para evitar duplicados
            if (window.riskTrendChart) {
                window.riskTrendChart.destroy();
            }
            if (window.geoDistributionChart) {
                window.geoDistributionChart.destroy();
            }

            // Datos de distribuci√≥n geogr√°fica
            const countryCounts = users.reduce((acc, user) => {
                acc[user.country] = (acc[user.country] || 0) + 1;
                return acc;
            }, {});

            const geoDistributionData = {
                labels: Object.keys(countryCounts),
                datasets: [{
                    label: 'N√∫mero de Usuarios',
                    data: Object.values(countryCounts),
                    backgroundColor: [
                        '#0057b7',
                        '#e0e0e0',
                        '#4caf50',
                        '#f44336',
                        '#ff9800',
                        '#9c27b0'
                    ],
                    hoverOffset: 4
                }]
            };

            const geoDistributionConfig = {
                type: 'doughnut',
                data: geoDistributionData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: 'white'
                            }
                        }
                    }
                }
            };
            window.geoDistributionChart = new Chart(document.getElementById('geo-distribution-chart'), geoDistributionConfig);
        }

        showSection('login-section');
    </script>
</body>
</html>